$(function(){$("div.navbar-default").css({backgroundColor:"#fff"})});function getimgdecode(){uphone=$.trim($("#phone").val());$("#discode").attr({src:"http://crm.yunjiaowu.cn/api/cms/getimgdecode?phone="+uphone+"&data="+new Date()})}$(function(){$("#phone").blur(function(){uphone=$.trim($("#phone").val());var b=/^1[3578]\d{9}$/;if(uphone==""){$(this).css({borderColor:"#e4393c"});$("#errophone").show().text("手机号不能为空");return false}else{if(!b.test(uphone)){$(this).css({borderColor:"#e4393c"});$("#errophone").show().text("填写正确手机号");return false}else{$(this).css({borderColor:"#1B6D85"});$("#errophone").hide();$("#scode").removeAttr("disabled");$("#discode").css({display:"inline-block"});getimgdecode()}}});$(function(){$("#scode").click(function(c){if($("#phone").val()==""||$("#discodeInput").val()==""){$("#errophone").show().text("未填写手机号或验证码");$("#scode").attr("disabled","true")}else{var b="http://crm.yunjiaowu.cn/api/cms/getcode";var f=60;var d=null;$.ajax({type:"get",url:b,data:{phone:$("#phone").val(),code:$("#discodeInput").val()},dataType:"jsonp",jsonp:"innerSignCallBack",jsonpCallback:"innerSignCallBack",success:function(g){var e=JSON.parse(g);console.log(e);if(e.errcode==4036){$("#errophone").show().text("图片验证码不能为空")}else{if(e.errcode==4037){$("#errophone").show().text("图片验证码错误");$("#discodeInput").val("")}else{d=setInterval(function(){f--;console.log(f);if(f==1){clearInterval(d);$("#scode").text("点击获取验证码");$("#scode").removeAttr("disabled")}else{$("#scode").text(f+"s以后重新验证");$("#scode").attr("disabled","true")}},1000)}}console.log(e)},error:function(e){console.log("失败")}})}})});function a(){$("#phone").val("");$("#clientName").val("");$("#linkmanName").val("");$("#phonecode").val("");$("#discodeInput").val("")}$("#but").click(function(){if($("#phone").val()!=""&&$("#clientName").val()!=""&&$("#linkmanName").val()!=""&&$("#phonecode").val()!=""){var c={phone:encodeURI($("#phone").val()),clientName:encodeURI($("#clientName").val()),linkmanName:encodeURI($("#linkmanName").val()),phonecode:$("#phonecode").val()};var b="http://crm.yunjiaowu.cn/api/cms/addclient";$.ajax({type:"get",url:b,data:c,dataType:"jsonp",jsonp:"innerSignCallBack",jsonpCallback:"innerSignCallBack",success:function(f){var e=JSON.parse(f);console.log(e);if(e.errcode===4032){$("#errophone").show().text("手机号码已被使用！");a()}else{if(e.errcode===0){alert("申请成功,请耐心等待");a()}else{$("#errophone").show().text(e.errmsg);a()}}},error:function(d){alert("申请失败，请重新申请！");a()}})}else{alert("您的信息未填写完整！请重新填写！");a()}})});